Description
The script uses hardcoded filenames for input and output, limiting its reusability.

Location
question_extractor/clean_question_bank.py:78

Rationale
Hardcoded filenames should be replaced with command-line arguments to make the script versatile.

Code context
if __name__ == "__main__":
    clean_file('Similarity Locus and Trigonometry questions.txt')

Description
The file contains a large `test` function at the end, mixing production code with test code.

Location
question_extractor/geometry_schema.py:600

Rationale
Tests should be in a separate directory (e.g., `tests/`) to keep production code clean and reduce file size.

Code context
# ============================================================================
# Testing
# ============================================================================

def test():
    """Test the figure parsing functionality."""

Description
The scripts `generate_diagrams.py` and `generate_paper_diagrams.py` contain almost identical logic for setting up the renderer and processing diagrams.

Location
question_extractor/generate_diagrams.py:1

Rationale
Code duplication increases maintenance burden. The shared logic should be extracted into a common utility function or script.

Code context
import os
import sys
import math
from pathlib import Path

# Add the current directory to the path so we can import the modules
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

Description
The script contains a hardcoded absolute path that is specific to a user's machine, which will cause failures on other systems.

Location
question_extractor/generate_diagrams.py:17

Rationale
Hardcoded paths break portability. The path should be relative or configurable via environment variables.

Code context
    # Ensure images directory exists
    output_dir = Path("C:/Users/mehna/OneDrive/Desktop/Student Qn papers/images")
    output_dir.mkdir(parents=True, exist_ok=True)

Description
The file contains a large `test` function at the end, mixing production code with test code.

Location
question_extractor/figure_renderer.py:924

Rationale
Tests should be in a separate directory (e.g., `tests/`) to keep production code clean and reduce file size.

Code context
# ============================================================================
# Testing
# ============================================================================

def test(output_dir: str = "./test_figures"):
    """Test figure rendering with sample figures."""


Description
The QuestionExtractor class is very large (>500 lines) and handles multiple concerns like PDF processing, prompt generation, and file I/O.

Location
question_extractor/extractor.py:208

Rationale
The class violates the Single Responsibility Principle. Extracting logic into separate classes (e.g., PromptGenerator, ResultsSaver) would improve maintainability.

Code context
class QuestionExtractor:
    """
    Main class for extracting questions from ICSE Math papers.
    
    This framework prepares PDFs for visual analysis and provides
    structured prompts for AI-powered question extraction.
    """
Description
The module uses global variables (`_worker_doc`, `_worker_pdf_path`) to share state with worker processes, which is fragile and hard to test.

Location
question_extractor/pdf_processor.py:17

Rationale
While common in `multiprocessing` with `fork`, it's better to use explicit initialization or a class-based worker to manage state cleanly.

Code context
# Global variable to hold the open document in worker processes
_worker_doc = None
_worker_pdf_path = None

@dataclass
class PDFPage:
